<!DOCTYPE html>
<html th:replace="~{fragments/layout :: layout(~{::head}, ~{::main})}">

<head th:replace="fragments/head :: head(~{}, 'Selecionar Endereço &ndash; PWEBII')"></head>

<body>

    <main class="container">
        <form th:action="@{/vendas/checkout}" method="post">
            <div class="row">
                <div class="col-md-4">
                    <label for="endereco" class="form-label">
                        Selecionar endereço existente
                    </label>
                    <select name="enderecoId" id="endereco" class="form-select">
                        <option th:each="e : ${pessoaSelecionada.getEnderecos()}" th:value="${e.id}" th:text="${e.descricao}"></option>
                    </select>
                </div>
            </div>

            <input type="hidden" name="pessoa_id" th:value="${pessoaSelecionada.id}">

            <button type="submit" class="btn btn-primary mt-3">
                Finalizar compra
            </button>
        </form>

        <form novalidate th:action="@{/vendas/add-delivery-address}" th:object="${endereco}" method="post" class="mt-5">
            <input type="hidden" name="pessoa_id" th:value="${pessoaSelecionada.id}">

            <fieldset>
                <legend class="mt-3">
                    Novo endereço
                </legend>

                <div class="row g-3">
                    <div class="col-md-3">
                        <label for="descricao_end" class="form-label">
                            Descrição do endereço
                        </label>
                        <input
                            type="text"
                            id="descricao_end"
                            class="form-control"
                            th:errorclass="is-invalid"
                            th:field="*{descricao}"
                            required
                            placeholder="Digite a descrição do endereço"
                            aria-describedby="validationEnderecoDescricao"
                        >
                        <div
                            th:if="${#fields.hasErrors('descricao')}"
                            th:errors="*{descricao}"
                            id="validationEnderecoDescricao"
                            class="invalid-feedback"
                        >
                            Dado incorreto.
                        </div>
                    </div>

                    <div class="col-md-3">
                        <label for="cep" class="form-label">
                            CEP
                        </label>
                        <input
                            type="number"
                            id="cep"
                            class="form-control"
                            th:errorclass="is-invalid"
                            th:field="*{cep}"
                            required
                            placeholder="Digite o CEP"
                            aria-describedby="validationEnderecoCEP"
                            maxlength="9"
                        />
                        <div
                            th:if="${#fields.hasErrors('cep')}"
                            th:errors="*{cep}"
                            id="validationEnderecoCEP"
                            class="invalid-feedback"
                        >
                            Dado incorreto.
                        </div>
                    </div>

                    <div class="col-md-3">
                        <label for="rua" class="form-label">
                            Rua
                        </label>
                        <input
                            type="text"
                            id="rua"
                            class="form-control"
                            th:errorclass="is-invalid"
                            th:field="*{logradouro}"
                            readonly
                            required
                            placeholder="Digite a rua"
                            aria-describedby="validationEnderecoLogradouro"
                        >
                        <div
                            th:if="${#fields.hasErrors('logradouro')}"
                            th:errors="*{logradouro}"
                            id="validationEnderecoLogradouro"
                            class="invalid-feedback"
                        >
                            Dado incorreto.
                        </div>
                    </div>

                    <div class="col-md-3">
                        <label for="complemento" class="form-label">
                            Complemento
                        </label>
                        <input
                            type="text"
                            id="complemento"
                            class="form-control"
                            th:field="*{complemento}"
                            placeholder="Digite o complemento"
                        >
                    </div>

                    <div class="col-md-3">
                        <label for="bairro" class="form-label">
                            Bairro
                        </label>
                        <input
                            type="text"
                            id="bairro"
                            class="form-control"
                            th:errorclass="is-invalid"
                            th:field="*{bairro}"
                            readonly
                            required
                            placeholder="Digite o bairro"
                            aria-describedby="validationEnderecoBairro"
                        >
                        <div
                            th:if="${#fields.hasErrors('bairro')}"
                            th:errors="*{bairro}"
                            id="validationEnderecoBairro"
                            class="invalid-feedback"
                        >
                            Dado incorreto.
                        </div>
                    </div>

                    <div class="col-md-3">
                        <label for="cidade" class="form-label">
                            Cidade
                        </label>
                        <input
                            type="text"
                            id="cidade"
                            class="form-control"
                            readonly
                            placeholder="Digite a cidade"
                        >
                    </div>

                    <div class="col-md-3">
                        <label for="uf" class="form-label">
                            Estado
                        </label>
                        <input
                            type="text"
                            id="uf"
                            class="form-control"
                            readonly
                            placeholder="Digite o estado"
                        >
                    </div>
                </div>

                <input readonly th:field="*{cidade.cod}" type="hidden" id="ibge" size="8"  value="0"/>
            </fieldset>

            <button type="submit" class="btn btn-primary mt-3">Adicionar novo endereço</button>
        </form>

        <script th:src="@{/js/cep.js}"></script>

    </main>

</body>
</html>
